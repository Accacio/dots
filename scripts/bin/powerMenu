#!/bin/bash
wallpaper=~/wallpapers/20170216_171846.jpg
# wallpaper=$(cat ~/wallpapers/currentWallpaper) #Current wallpaperjj
# menu_fun='dmenu'
menu_fun='rofi -dmenu -theme nord'
exec 3>&1;

menu=('Shutdown' 'Restart' 'Lock' 'Loki' 'Logoff')
mode=$(printf '%s\n' "${menu[@]}"|sed 's/^ //'|$menu_fun -b -sb seagreen -i -p "Power Menu")
case $mode in
    Loki)
    TMPBG=/tmp/screen.png
    RES=$(xrandr | grep 'current' | sed -E 's/.*current\s([0-9]+)\sx\s([0-9]+).*/\1x\2/')

    ffmpeg -f x11grab -video_size $RES -y -i $DISPLAY -vframes 1 $TMPBG -loglevel quiet
    i3lock -i $TMPBG -u
    rm $TMPBG
    ;;
    Lock)
    prettyLock
    ;;
    Shutdown)
    # notify-send "Saving Org Folder to Dropbox"
    # rclone -l copy ~/org dbox:org -P && notify-send "Finished Copying Dbox ⬅ Org"
    # notify-send "Saving These Folder to Dropbox"
    # rclone -l copy ~/these dbox:these -P && notify-send "Finished Copying Dbox ⬅ These"
    shutdown now
    ;;
    Logoff)
    # notify-send "Saving Org Folder to Dropbox"
    # rclone -l copy ~/org dbox:org -P && notify-send "Finished Copying Dbox ⬅ Org"
    # notify-send "Saving These Folder to Dropbox"
    # rclone -l copy ~/these dbox:these -P && notify-send "Finished Copying Dbox ⬅ These"
    i3-msg exit
    bspc quit
    qdbus org.kde.Shutdown /Shutdown logout
    echo "awesome.quit()" | awesome-client
    ;;
    Restart)
    # notify-send "Saving Org Folder to Dropbox"
    # rclone -l copy ~/org dbox:org -P && notify-send "Finished Copying Dbox ⬅ Org"
    # notify-send "Saving These Folder to Dropbox"
    # rclone -l copy ~/these dbox:these -P && notify-send "Finished Copying Dbox ⬅ These"
    shutdown -r now
    ;;
esac
